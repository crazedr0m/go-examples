# Используем официальный образ Golang как базовый
FROM golang:1.24-alpine AS builder

# Устанавливаем рабочую директорию внутри контейнера
WORKDIR /app

# Копируем файлы с исходным кодом Go
COPY . .

# Собираем бинарный файл нашего приложения
RUN go build -o main .

# Используем минимальный образ Alpine для уменьшения размера
FROM alpine:latest

# Устанавливаем рабочую директорию
WORKDIR /root/
# Копируем собранный бинарный файл из предыдущего этапа сборки
COPY --from=builder /app/main .
#COPY --from=builder /app/config.yml .

# Порт, на котором будет работать приложение
#EXPOSE 8080

# Команда для запуска нашего приложения при запуске контейнера
CMD ["./main"]